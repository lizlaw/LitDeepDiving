---
title: "Semi-automated rapid evidence mapping"
author: "Liz Law, Matt Grainger"
date: "11/9/2020"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Patience please :)
Liz is learning how to do these slides with R-markdown in a safe and friendly environment.
Sorry for the lack of pretty details etc.

![](https://media.giphy.com/media/UxREcFThpSEqk/giphy.gif)

## Searching the literature

Motivating problem(s)

- Complex search terms (AND, OR, NEAR…TOPICS, TITLES, TYPES… SOURCES, YEARS…)
- Unknown search terms (familiar with only part of the literature)
- Getting too much literature (and lots of junk)
- Getting not enough literature (missing many key papers)

Particularly issues with broad/complex issues (like everything conservation)

## General advice for searching

MATT to add 

[KeyWords Plus](https://support.clarivate.com/ScientificandAcademicResearch/s/article/KeyWords-Plus-generation-creation-and-changes?language=en_US): important words extracted from the _title of references cited_ (WoS only). Included in TOPIC search. 

## Example of the problem
Aim: summarise evidence for impacts of managed bees on native bees

Broad topic: 

- managed bees can be Apis, Bombus, ...
- native bees can also be many 
- common names ("honeybee", "pollinators", ...) 
- many direct (nesting, foraging) and indirect (plant, pests, pesticides) interactions
- overlap of literatures: entomology, plant ecology, ecosystem services,...

## Example of the problem - search terms
| Category| Term list |
|:--------|:----------|
|Managed|(African* NEAR bee) OR Apis OR Bombus OR "bumble bee" OR bumblebee* OR "honey bee" OR honeybee OR ((introduc* OR inva* OR non-native OR nonnative OR commercial OR exotic OR feral OR managed) NEAR (bee OR pollin*))| 
|Native|(((cavity OR ground) NEAR nesting) OR (native OR solitary OR wild)) NEAR (bee OR pollin*)|
|Interaction|pollinat* OR network* OR “niche overlap” OR “partitioning” OR interact* OR competit* OR facilitat* OR mutualis* OR “resource limitation” OR hybridization OR introgression OR dependence OR assemblag* OR overlap OR spillover OR impact*|

## Example of the problem - search results
| Search                               | Number of results |
|:-------------------------------------|:------------------|
|TOPIC(M AND N AND I), ALL             | 2,406 |
|TOPIC(M AND N), TITLE(I), ALL         | 1,127 |
|TITLE(M AND N AND I), ALL             |   194 |
|TOPIC(M AND N AND I), ALL, _near> and_| 3,746 |
|TOPIC(M AND N AND I), DocType = Review|   167 |
|TOPIC(M AND N AND I AND review terms) | 258 (95)|

: Searched Web of Science on 11/16/2020

## Two solutions (not mutually exclusive)

1. "improve"/narrow search terms further
    
    - caveat: requires you to have a well defined "in-group"

2. characterise the literature first, then select

    - based on keywords, abstracts, cited literature

## Improving search terms: 

- include NEAR, NOT, SAME
- restrict document types, years, language
- restrict research areas / journals
- select top-n by times cited, relevance (Title, Abstract, Keywords, Keywords Plus)
- see: [advanced search tab](https://images.webofknowledge.com/WOKRS535R100/help/WOS/hp_advanced_search.html)

Emerging approaches:

- semi-automated
- word groups (N-grams, or word co-occurences in ordered sets)

## Improving search terms: litsearchr 

- partially automates keyword selection and writing Boolean search strings
- uses the Rapid Automatic Keyword Extraction algorithm to identify potential keywords from a scoping search 
- selects important keywords based on their importance in a keyword co-occurrence network
- after keywords are grouped into concept groups, litsearchr writes Boolean searches

## litsearchr example 1.1: Load example literature

Using the Red-cockaded woodpecker example in {package::litsearchr}

- We use a "scoping search" to get some literature and deduplicate (n = 156)

```{r litsearchr example, echo=FALSE, message=FALSE, warning=FALSE}

library(litsearchr)
library(synthesisr)
library(tidyverse)

file_names <- c(
  system.file("extdata", "scopus.ris", package = "synthesisr"),
  system.file("extdata", "zoorec.txt", package = "synthesisr"))
data <- synthesisr::read_refs(file_names)

cleaned_data <- synthesisr::deduplicate(data,
                                        match_by = "title",
                                        method = "string_osa",
                                        rm_punctuation = TRUE,
                                        to_lower = TRUE)
```


```{r echo=FALSE}

knitr::kable(cleaned_data %>% 
  select(year, title) %>% 
  head(3))
  
```

## litsearchr example 1.2: Find co-occuring keywords

- Then using the "rake" algorithm we find co-occurring keywords from the abstracts

```{r}
rake_keywords <- litsearchr::extract_terms(cleaned_data$abstract,
                                           method = "fakerake",
                                           min_freq = 5,
                                           stopwords ="English")

knitr::kable(sample_n(as_tibble(rake_keywords)
         , 5))

```

```{r echo=FALSE}
naive_dfm <- litsearchr::create_dfm(
  elements = cleaned_data$abstract,
  features = rake_keywords)
naive_graph <- litsearchr::create_network(
  search_dfm = as.matrix(naive_dfm),
  min_studies = 1,
  min_occ = 1)
spline_cutoff <- litsearchr::find_cutoff(naive_graph,
                                         method = "cumulative",
                                         percent = 0.3,
                                         knot_num = 3)
reduced_graph <- litsearchr::reduce_graph(naive_graph,
                                          cutoff_strength = spline_cutoff)
search_terms <- litsearchr::get_keywords(reduced_graph)
#Finally, we can group terms together and write a Boolean search:
 search_groups <- split(search_terms,
                       factor(
                         2 - as.numeric(grepl("forest|log", search_terms)),
                         levels = seq_len(2),
                         labels = c("forest", "not forest")))
woodpecker_search <- litsearchr::write_search(search_groups,
                                              languages = "English",
                                              stemming = TRUE,
                                              closure = "left",
                                              exactphrase = TRUE,
                                              writesearch = FALSE,
                                              verbose = TRUE)
```

## litsearchr example 1.3: Reduce keywords

- Then we can reduce these keywords down to a smaller set

```{r keyword graph}

plot(reduced_graph)
```

## litsearchr example 1.4: Output search string

- Then we can output a search string. 

Search terms are outputted automatically: `r paste0(woodpecker_search) `

WoS search: TOPIC: (("burn* forest* "  OR "salvag* logging")  AND ("back* woodpeck* "  OR "picoid* arcticus*"))
= 52 articles (input in 156)

## litsearchr example 2.1: Bee literature, suggested papers

Using our Bee literature

- our team suggested 16 papers that would be suitable
- Same process as before (except min_freq = 2)

```{r litsearchr example 2, echo=FALSE, message=FALSE, warning=FALSE}

library(litsearchr)
library(synthesisr)
library(tidyverse)

file_names <- "data/suggested.bib"
data <- synthesisr::read_refs(file_names)

cleaned_data <- synthesisr::deduplicate(data,
                                        match_by = "title",
                                        method = "string_osa",
                                        rm_punctuation = TRUE,
                                        to_lower = TRUE)

rake_keywords <- litsearchr::extract_terms(cleaned_data$abstract,
                                           method = "fakerake",
                                           min_freq = 2,
                                           stopwords ="English")

naive_dfm <- litsearchr::create_dfm(
  elements = cleaned_data$abstract,
  features = rake_keywords)
naive_graph <- litsearchr::create_network(
  search_dfm = as.matrix(naive_dfm),
  min_studies = 1,
  min_occ = 1)
spline_cutoff <- litsearchr::find_cutoff(naive_graph,
                                         method = "cumulative",
                                         percent = 0.3,
                                         knot_num = 3)
reduced_graph <- litsearchr::reduce_graph(naive_graph,
                                          cutoff_strength = spline_cutoff)
search_terms <- litsearchr::get_keywords(reduced_graph)
#Finally, we can group terms together and write a Boolean search:
bee_search <- litsearchr::write_search(search_terms,
                                              languages = "English",
                                              stemming = TRUE,
                                              closure = "left",
                                              exactphrase = TRUE,
                                              writesearch = FALSE,
                                              verbose = TRUE)
```

Search terms: `r paste0(bee_search) `

TOPIC: (("climat* chang* ")  AND ("ecosystem* servic* ")  AND ("pollin* popul* ")  AND ("pollin* servic*"))  
= 6 results, all relevant, but possibly a little restrictive!

## summary on litsearcher

Benefits: 

- really great for narrowing down useful co-occurence terms

Caveats:

- needs good sample literature


## Approach #2: Grouping the literature, then narrow down

Concept is to utilize the citation records to group the literature

'Clustering' can utilize data from keywords, cited references, journals, and/or terms extracted from titles and abstracts

Characterise the clusters by keywords, "topic models", "reading lists"

Options in Scimeetr, revtools, bibliometrix


## scimeetr 

Designed to "help explore the literature" by

- characterising literature communities by keywords (title, abstract, keywords, keywords+, and cited references)
- return tags, top keywords, authors, cited literature
- generate reading lists by ranking, OR bibiography network characteristics

Clustering based on:

- igraph::cluster_louvain() or igraph::cluster_fast_greedy() (self-stopping)
- using cited references, keywords, title, abstract (some cleaning using tm)

Caveats: 

- only on github, 'beta' version, ? on further development
- may need some further 'cleaning' and customising
- for example:
     - Year is missing for many interesting early access
     - may need 'stemming' of keywords, for some purposes
     - may need to identify 'synonyms' and possibly compount terms in data cleaning.

## scimeetr example

* add example here

## bibliometrix

Similarly to scimeetr

- provides an easy way to characterise the data
- e.g. plots by year

Differently to scimeetr

- More network plot options (plot co-author, country networks)
- Fewer integrated grouping options
- R-cran, more stable (?)

Clustering based on:

- keywords, title, OR abstract (optional 'stemming')
- Multiple Correspondence Analysis (default), or CA, MDS
- then k-means clustering on this (k = "auto" or user-supplied)

Caveats

- similarly to scimeetr, data may need pre-cleaning
- annoying change of column labels from wos import

## bibliometrix example

MATT to Add??

## summary on litsearchr, scimeetr, bibliometrix

- litsearchr useful, but should be part of a process including
- scimeetr (Liz' preference) or bibliometrix

BUT

- best practice would be iterative, documented (eg. in R)
- AND involve further cleaning, processing of data & terms

## Going further

Facilitated title and abstract screening using revtools

- allocates randomly to participants
- title, blinded to other details (authors etc)
- in/out/unsure

And/or...

## Diving deeper

doi2text

- automates finding of full text 
- identifies sections

text mining of (primary) literature 

e.g.

- searching for specific terms within the methods/results text 
  - species / species types 
  - landscapes / locations
  - sampling methods (pan, malaise, netting, etc)
- searching for data in figures and tables through legends
  
caveats(?) 

  - needs to be fed in 'lists' 
  - but this useful for standardisation of the literature
  - we can potentially automate creation of these lists via text mining

## summary
Literature searches are extremely subjective

 - what words/terms to include
 - how to combine
 - which fields to search
 - how to narrow down to a manageable set
 
Automated search tools apply algorithms to make at least part of the process transparent and repeatable.

- despite requiring many more subjective decisions
- attention to :
   - stopwords, stemming, N-grams
   - quality data in
   - 


